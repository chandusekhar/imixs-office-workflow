<f:subview xmlns="http://www.w3.org/1999/xhtml"
	xmlns:c="http://java.sun.com/jsp/jstl/core"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:i="http://java.sun.com/jsf/composite/imixs"
	xmlns:ui="http://java.sun.com/jsf/facelets" id="workitem_footer_id">


	<!-- *** Workflow (Author) **** -->

	<h1>#{message.workflow}</h1>

	<c:choose>
		<c:when
			test="#{workflowController.workitem.item['$isAuthor'] or workflowController.newWorkitem}">
			<h:panelGroup
				rendered="#{workflowController.workitem.item['type'] ne 'workitemdeleted'}">
				<i:imixsWorkflowActions workflowController="#{workflowController}" />
			</h:panelGroup>
			<!-- Delete/Restore -->
			<h:panelGroup
				rendered="#{loginController.isUserInRole('org.imixs.ACCESSLEVEL.MANAGERACCESS')}">
				<!-- *** Soft Delete  *** -->
				<h:commandButton action="home" immediate="true" styleClass="imixs-delete-action"
					onclick="if (!confirm('#{message.help_delete}')) return false;"
					rendered="#{workflowController.workitem.item['type'] eq 'workitem' or workflowController.workitem.item['type'] eq 'workitemarchive'}"
					actionListener="#{workflowController.doSoftDeleteWorkitem}"
					value="#{message.delete}">
				</h:commandButton>
				<!-- *** Restore Soft Delete  *** -->
				<h:commandButton immediate="true" styleClass="imixs-delete-action"
					rendered="#{workflowController.workitem.item['type'] eq 'workitemdeleted' or workflowController.workitem.item['type'] eq 'workitemarchivedeleted'}"
					actionListener="#{workflowController.doRestoreFromDeletions}"
					value="#{message.restore}">
				</h:commandButton>
			</h:panelGroup>

		</c:when>

		<!-- ReadOnly Modus -->
		<c:otherwise>
			<!-- jQuery code to disable all input elements in read modus -->
			<script type="text/javascript">
				/*<![CDATA[*/
				$(".imixs-body :input").attr("disabled", true);
				
				// remove imixs-data class
				$(".imixs-date").removeClass("imixs-date");
				$("#imixs_file_upload, #imixs-add-file-link").hide();
				$(".imixs-action-dms-comment, .imixs-action-dms-remove, .marty-workitemlink-entry-remove, .marty-workitemlink-inputbox").hide();

				// imixs link input
				$('.marty-workitemlink').addClass("imixs-input-disabled");
				/*]]>*/
			</script>
		</c:otherwise>

	</c:choose>


	<!-- *** Close  *** -->
	<h:commandButton immediate="true" action="home"
		value="#{message.close}" styleClass="imixs-close-action"
		actionListener="#{historyController.closeCurrentWorkitem}">
	</h:commandButton>


	<!-- ** Print ** -->
	<input type="button" value="#{message.print}"  class="imixs-print-action"
		onclick="openPrintWindow();" />
	<script type="text/javascript">
		function openPrintWindow() {
			fenster = window
					.open(
							"#{facesContext.externalContext.requestContextPath}/pages/workitems/workitem_print.jsf",
							"message.print",
							"width=1100,height=700,status=no,scrollbars=yes,resizable=yes");
			fenster.focus();
		}
	</script>

</f:subview>
