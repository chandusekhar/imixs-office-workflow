<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:c="http://java.sun.com/jsp/jstl/core"
	xmlns:h="http://java.sun.com/jsf/html">


	<h:panelGroup layout="block" id="minute_edit_section"
		styleClass="imixs-subform minute_layout_region"
		style="margin-bottom: 20px;">

		<!-- Head -->
		<h:panelGroup layout="block" style="margin: 5px 0 0 12px;"
			rendered="#{(!minuteController.newWorkitem)}">
			<!-- *** Sequence Number -->
			<div class="minute-number">
				<span>#{workitem.item['numsequencenumber']}.</span>
			</div>

			<div class="minute-info">
				<!-- Status -->
				<h:outputText style="font-weight: bold;"
					value="#{workitem.item['txtworkflowgroup']}: " />
				<h:outputText value="#{workitem.item['txtworkflowstatus']}" />

				<!-- Crated -->
				<br /> <span> <h:outputText style="font-weight: bold;"
						value="#{message.created}: " /> <h:outputText
						value="#{workitem.item['$modified']}" style="font-weight: normal;">
						<f:convertDateTime timeZone="#{message.timeZone}"
							pattern="#{message.dateTimePatternShort}" />
					</h:outputText> <h:outputText
						value=" #{message.by} #{userController.getUserName(workitem.item['namcreator'])}" />
				</span>

				<!-- Modified -->
				<br /> <span> <h:outputText style="font-weight: bold;"
						value="#{message.modified}: " /> <h:outputText
						value="#{workitem.item['$modified']}" style="font-weight: normal;">
						<f:convertDateTime timeZone="#{message.timeZone}"
							pattern="#{message.dateTimePatternShort}" />
					</h:outputText> <h:outputText
						value=" #{message.by} #{userController.getUserName(workitem.item['namcurrentEditor'])}" />
				</span>

			</div>
		</h:panelGroup>
		
		<!-- Edit section -->
		<div class="imixs-form-section">
			<dl>
				<dt>
					#{message['form.minutes.subject_minute']}: <span
						class="imixs-required">*</span>
				</dt>
				<dd>
					<h:inputText title="#{message['form.minutes.help_subject']}"
						required="true" value="#{workitem.item['_subject']}" />
				</dd>
			</dl>
			<dl>
				<dt>#{message['form.minutes.description']}</dt>
				<dd>
					<h:inputTextarea id="tinymce-minute-editor"
						class="imixs-minute-editor"
						value="#{workitem.item['_description']}" />
				</dd>
			</dl>
		</div>


		<h:panelGroup layout="block" styleClass="imixs-form-section-2">
			<dl>
				<dt>#{message['form.minutes.deadline']}:</dt>
				<dd>
					<h:inputText value="#{workitem.item['datdate']}"
						title="#{message['form.minutes.help_deadline']}"
						class="imixs-date">
						<f:convertDateTime pattern="#{message.datePatternShort}"
							timeZone="#{message.timeZone}" />
					</h:inputText>
				</dd>
			</dl>

			<dl>
				<dt>#{message['form.minutes.responsible']}:</dt>
				<dd>
					<h:selectOneMenu value="#{workitem.item['namresponsible']}"
						title="#{message['form.minutes.help_responsible']}">
						<f:selectItem itemLabel=" - " itemValue=" "></f:selectItem>
						<c:forEach
							items="#{workflowController.workitem.itemList['_Team']}"
							var="member">
							<f:selectItem itemLabel="#{userController.getUserName(member)}"
								itemValue="#{member}"></f:selectItem>
						</c:forEach>
					</h:selectOneMenu>
				</dd>

			</dl>
		</h:panelGroup>


		<!-- comment log -->
		<h:panelGroup
			rendered="#{! empty workitem.getItemValue('txtCommentLog')}">
			<dl>
				<dt>
					<h:outputLabel value="#{message['form.comment.history']}:" />
				</dt>
				<dd>
					<h:panelGrid columns="3" rowClasses="topAligned"
						styleClass="imixs-commentlist">
						<c:forEach items="#{workitem.getItemValue('txtCommentLog')}"
							var="comment">
							<c:if test="#{!empty comment}">
								<h:outputText value="#{comment.datcomment}"
									style="margin-right:10px;">
									<f:convertDateTime timeZone="#{message.timeZone}" type="both"
										pattern="#{message.dateTimePatternShort}" />
								</h:outputText>

								<h:outputText
									value="#{userController.getUserName(comment.nameditor)}" />


								<h:outputText value="#{comment.txtcomment}" />
							</c:if>
						</c:forEach>

					</h:panelGrid>
				</dd>
			</dl>
		</h:panelGroup>



		<!-- Workflow Actions -->
		<div class="imixs-form-section">
			<ui:include src="/pages/error_message.xhtml" />

			<ui:repeat var="activity" value="#{minuteController.events}">
				<h:commandButton role="button" onclick="saveTinyMCE();"
					class="imixs-workflow-action ui-button-warning" title=" "
					actionListener="#{minuteController.process(activity.item['numactivityid'],true)}"
					value="#{activity.item['txtname']}">
					<f:ajax render=":#{minutesBody.clientId}"
						execute=":#{minutesBody.clientId}" onevent="layoutBodySection" />
				</h:commandButton>
			</ui:repeat>

			<h:commandButton role="button" value="#{message.close}"
				class="imixs-close-action ui-button" onclick="closeMinuteEditor();"
				actionListener="#{minuteController.reset}">
				<f:ajax render=":#{minutesBody.clientId}"
					execute=":#{minutesBody.clientId}" onevent="layoutBodySection" />
			</h:commandButton>

		</div>
	</h:panelGroup>


</ui:composition>
