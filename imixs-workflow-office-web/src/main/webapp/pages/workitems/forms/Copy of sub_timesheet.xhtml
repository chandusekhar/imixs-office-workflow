<f:subview xmlns="http://www.w3.org/1999/xhtml"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:c="http://java.sun.com/jstl/core"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:a4j="http://richfaces.org/a4j"
	xmlns:rich="http://richfaces.org/rich" id="sub_timesheet_form">


	<rich:dataTable id="child_datatable_ID" columns="8" rows="5"
		value="#{workitemMB.childs}" var="child" sortMode="multi"
		styleClass="sywapp-subform-table">

		<rich:column>
			<f:facet name="header">
				<h:outputText value="#{form_messages.sub_timesheet_date}" />
			</f:facet>
			<h:outputText value="#{child.item['_date']}">
				<f:convertDateTime timeZone="#{global.timeZone}"
					pattern="#{global.datePattern}" />
			</h:outputText>
		</rich:column>

		<rich:column>
			<f:facet name="header">
				<h:outputText value="#{form_messages.sub_timesheet_duration}" />
			</f:facet>
			<h:outputText value="#{child.item['_duration']}" />
		</rich:column>

		<rich:column sortBy="#{child.item['_subject']}" sortable="true"
			sortExpression="#{child.item['_subject']}">
			<f:facet name="header">
				<h:outputText value="#{form_messages.sub_timesheet_subject}" />
			</f:facet>
			<h:outputText value="#{child.item['_subject']}" />
		</rich:column>

		<rich:column sortable="true" sortBy="#{child.item['_category']}"
			sortExpression="#{child.item['_category']}">
			<f:facet name="header">
				<h:outputText value="#{form_messages.sub_timesheet_category}" />
			</f:facet>
			<h:outputText value="#{child.item['_category']}" />
		</rich:column>


		<rich:column sortBy="#{child.item['txtworkflowstatus']}"
			sortable="true" sortExpression="#{child.item['txtworkflowstatus']}">
			<f:facet name="header">
				<h:outputText value="Status" />
			</f:facet>
			<h:outputText value="#{child.item['txtworkflowstatus']}" />
		</rich:column>



		<rich:column>
			<f:facet name="header">
                    #{global.action}
                </f:facet>

			<!-- Edit Action -->
			<rich:toggleControl for="suggest_process_id"
				id="edit_button_id_control" switchToState="time_editor_open">
				<a4j:commandButton image="/layout/icons/Edit_16.png"
					actionListener="#{timeSheetMB.doEdit}"
					reRender="time_editor_panel_id" value="#{global.edit}"
					id="edit_button_id" />
			</rich:toggleControl>
			<rich:toolTip for="edit_button_id_control" value="#{global.edit}" />

			<!-- Delete Action -->
			<a4j:commandButton image="/layout/icons/Delete_16.png"
				style="margin-left:10px;" actionListener="#{timeSheetMB.doEdit}"
				oncomplete="#{rich:component('deletePanel')}.show()"
				reRender="deletePanel" value="#{global.delete}"
				id="delete_button_id" />
			<rich:toolTip for="delete_button_id" value="#{global.delete}" />




		</rich:column>


	</rich:dataTable>
	<rich:datascroller for="child_datatable_ID" />


	<!-- Editor  -->
	<rich:togglePanel switchType="ajax" id="suggest_process_id"
		validatorMessage="Error"
		stateOrder="time_editor_closed,time_editor_open">

		<!-- Editor Panel closed -->
		<f:facet name="time_editor_closed">
			<a4j:outputPanel>
				<rich:toggleControl for="suggest_process_id"
					switchToState="time_editor_open" reRender="time_editor_panel_id">
					<a4j:commandButton actionListener="#{timeSheetMB.doCreate}"
						reRender="time_editor_panel_id" value="#{global.add}">
						<f:param name="id"
							value="#{workitemMB.workitem.item['$modelversion']}|6100" />
					</a4j:commandButton>

				</rich:toggleControl>
			</a4j:outputPanel>
		</f:facet>


		<!-- Editor Panel open -->
		<f:facet name="time_editor_open">

			<a4j:outputPanel id="time_editor_panel_id" layout="block"
				styleClass="sywapp-subform-body">

				<a4j:outputPanel style="float:left; width:300px;">
					<dl class="columns-1">
						<dt>
							<h:outputText value="#{form_messages.sub_timesheet_date}: " />
						</dt>
						<dd>
							<rich:calendar value="#{workitemMB.child.item['_date']}" />
						</dd>
						<dt>
							<h:outputText value="#{form_messages.sub_timesheet_duration}: " />
						</dt>

						<dd>
							<h:inputText id="ln"
								value="#{workitemMB.child.item['_duration']}" required="false"
								style="width:30px;">


							</h:inputText>
						</dd>


						<dt>
							<h:outputText value="#{form_messages.sub_timesheet_category}: " />
						</dt>
						<dd>
							<h:inputText value="#{workitemMB.child.item['_category']}"
								style="width:70px;" />
						</dd>
					</dl>
				</a4j:outputPanel>

				<a4j:outputPanel style="float:left; width:200px;">
					<dl>
						<dt>

							<h:outputText value="#{form_messages.sub_timesheet_subject}: " />
						</dt>
						<dl>
							<h:inputText value="#{workitemMB.child.item['_subject']}"
								style="width:280px;" />

						</dl>
					</dl>
				</a4j:outputPanel>
				<div style="clear:left;" />
				<rich:message style="color:red;" for="ln" />
				<br />

				<!-- *** Workflow Actions **** -->
				<ui:repeat value="#{workitemMB.childActivities}" var="activitychild">

					<rich:toggleControl for="suggest_process_id"
						switchToState="time_editor_closed">
						<a4j:commandButton actionListener="#{workitemMB.doProcessChild}"
							reRender="child_datatable_ID"
							value="#{activitychild.item['txtname']}">
							<f:param name="id" value="#{activitychild.item['numactivityid']}" />
						</a4j:commandButton>
					</rich:toggleControl>
				</ui:repeat>


				<rich:toggleControl for="suggest_process_id"
					switchToState="time_editor_closed">
					<a4j:commandButton value="#{global.close}">

					</a4j:commandButton>

				</rich:toggleControl>

			</a4j:outputPanel>
		</f:facet>
	</rich:togglePanel>






	<!-- Delete Dialog -->
	<rich:modalPanel id="deletePanel" autosized="true" width="200">
		<f:facet name="header">
			<h:outputText value="#{form_messages.sub_timesheet_delete_help}"
				style="padding-right:15px;" />
		</f:facet>
		<f:facet name="controls">
			<h:panelGroup>
				<h:graphicImage value="/layout/icons/close.gif"
					styleClass="hidelink" id="hidelink2" />
				<rich:componentControl for="deletePanel" attachTo="hidelink2"
					operation="hide" event="onclick" />
			</h:panelGroup>
		</f:facet>
		<h:outputText value="#{workitemMB.child.item['_date']}">
			<f:convertDateTime timeZone="#{global.timeZone}"
				pattern="#{global.datePattern}" />
		</h:outputText>
		<h:outputText value=" :  #{workitemMB.child.item['_subject']}" />
		<table style="width: 100%">
			<tbody>
				<tr>
					<td align="center" width="50%"><a4j:commandButton
							value="#{global.yes}" ajaxSingle="true"
							actionListener="#{workitemMB.doDeleteChild}"
							oncomplete="#{rich:component('deletePanel')}.hide();"
							reRender="child_datatable_ID" /></td>
					<td align="center" width="50%"><a4j:commandButton
							value="#{global.no}"
							onclick="#{rich:component('deletePanel')}.hide();return false;" />
					</td>
				</tr>
			</tbody>
		</table>

	</rich:modalPanel>




</f:subview>

