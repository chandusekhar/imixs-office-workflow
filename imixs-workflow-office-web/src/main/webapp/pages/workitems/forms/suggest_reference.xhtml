<f:subview xmlns="http://www.w3.org/1999/xhtml"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:a4j="http://richfaces.org/a4j"
	xmlns:rich="http://richfaces.org/rich"
	xmlns:cc="http://java.sun.com/jsp/jstl/core">



	<a4j:outputPanel layout="block" id="workitem_block">
	
	
	<!-- Process refrences -->
		<a4j:outputPanel layout="block"
			rendered="#{! empty handler.references}"
			style="margin-bottom:5px;">


			<rich:dataList id="processlist_id" value="#{handler.references}" var="workitem"
			rowClasses="sywapp-viewentry " >


				<a4j:outputPanel  layout="block"
					style="border-bottom: 1px solid silver;margin-bottom:5px;padding-bottom:5px;">
					<h:commandLink
						actionListener="#{handler.doSwitchToWorkitem}"
						action="open_workitem">
						
						<h:outputText
							value="#{workitem.item['txtWorkflowSummary']}"
							rendered="#{!empty workitem.item['txtWorkflowSummary']}" />

						<f:param name="id" value="#{workitem.item['$uniqueid']}" />


					</h:commandLink>
					<br />
					<h:outputText style="font-weight: normal;"
						value="#{workitem.item['txtworkflowgroup']}: " />
					<h:outputText
						value="#{workitem.item['txtworkflowstatus']}" />


					<h:commandLink style="margin-left:15px;" value="[#{global.remove}]"
						reRender="workitem_block,#{rerender_id}"
						actionListener="#{handler.doRemoveReference}">
						<f:param name="id" value="#{workitem.item['$uniqueid']}" />

					</h:commandLink>

				</a4j:outputPanel>

			</rich:dataList>
		</a4j:outputPanel>

		<a4j:region id="suggestbox_region1" rendered="#{! readonly}">

			<rich:togglePanel switchType="client" id="suggest_process_id"
				stateOrder="closed_mode,edit_mode">

				<f:facet name="closed_mode">
					<!-- closed -->
					<a4j:outputPanel>
						<rich:toggleControl for="suggest_process_id">
			                [#{global.add}]
			            </rich:toggleControl>

					</a4j:outputPanel>
				</f:facet>

				<f:facet name="edit_mode">

					<a4j:outputPanel>
						<!-- ##########  Box with input field for workitem search ################ -->
						<a4j:outputPanel layout="block" style="float:left;">
							<h:inputText id="suggestbox_user_input1" style="width:100px;" />
							<a4j:status for="suggestbox_region1">
								<f:facet name="start">
									<h:graphicImage value="/layout/icons/ajax-loader.gif" />
								</f:facet>
							</a4j:status>
						</a4j:outputPanel>

						<!-- ##########  Tooltip ################ -->
						<rich:toolTip for="suggestbox_user_input1" layout="block"
							followMouse="true">
							<h:outputText escape="false" value="#{tooltip}" />
						</rich:toolTip>

						<!-- ##########  Suggestbox for Usersuche ################ -->

						<rich:suggestionbox  for="suggestbox_user_input1" minChars="3"
							fetchValue="" nothingLabel="No entry found"
							usingSuggestObjects="true" 
							suggestionAction="#{handler.suggestProcess}"
							var="suggest" width="300">
							<h:column>
								<h:outputText value="#{suggest.item['$modified']}">
									<f:convertDateTime timeZone="#{global.timeZone}"
										pattern="#{global.dateTimePatternShort}" />
								</h:outputText>

								<h:outputText value=": #{suggest.item['txtWorkflowSummary']}"
									rendered="#{!empty suggest.item['txtWorkflowSummary']}" />
								<br />
								<h:outputText style="font-weight: bold;"
									value="#{suggest.item['txtworkflowgroup']}: " />
								<h:outputText value="#{suggest.item['txtworkflowstatus']}" />

							</h:column>

							<a4j:support event="onselect"
								reRender="workitem_block,#{rerender_id}">
								<f:setPropertyActionListener
									value="#{suggest.item['$uniqueid']}"
									target="#{handler.newProcessReference}" />
							</a4j:support>

						</rich:suggestionbox>


						<rich:toggleControl for="suggest_process_id">
							<h:outputText style="margin-left:10px;" value="#{global.close}" />
						</rich:toggleControl>
					</a4j:outputPanel>


				</f:facet>



			</rich:togglePanel>



		</a4j:region>



	</a4j:outputPanel>

</f:subview>